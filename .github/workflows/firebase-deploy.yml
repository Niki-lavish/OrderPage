# GitHub Actions 工作流程設定檔
# 功能：當程式碼被推送到 main 分支時，自動部署到 Firebase Hosting。

name: Automatic Deploy to Firebase Hosting

on:
  push:
    branches:
      - main  # 只針對 main 分支的推送 (push) 事件觸發

jobs:
  deploy:
    runs-on: ubuntu-latest  # 使用最新的 Ubuntu 虛擬環境來執行工作
    
    steps:
      # 步驟 1: 取得您的原始碼
      # 這個動作會將您的 GitHub 儲存庫程式碼，下載到虛擬環境中。
      - name: Checkout repository
        uses: actions/checkout@v4

      # 步驟 2: 設定 Node.js 環境
      # 我們需要 Node.js 來安裝依賴套件和建置專案。
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # 使用與我們專案一致的 Node.js 版本

      # 步驟 3: 安裝專案相依套件
      # 執行 npm install 來下載所有需要的函式庫。
      - name: Install Dependencies
        run: npm install

      # 步驟 4: 建置專案
      # 執行 npm run build，將 Vue 專案編譯成最終的靜態檔案。
      - name: Build Project
        run: npm run build

      # 步驟 5: 部署到 Firebase Hosting
      # 安裝 Firebase 工具，並使用安全的「通行證」來執行部署。
      - name: Deploy to Firebase Hosting
        run: |
          npm install -g firebase-tools
          firebase deploy --only hosting --token "${{ secrets.FIREBASE_TOKEN }}"
